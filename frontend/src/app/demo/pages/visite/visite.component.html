<div class="container mt-3">
  <h3>Planning des visites pour le bien ID: {{ bienId }}</h3>

  <!-- Formulaire pour ajouter une visite -->
<form (ngSubmit)="addVisite()" class="mb-3">
  <div class="mb-2">
    <label>Visiteur</label>
    <select [(ngModel)]="newVisite.visiteurId" name="visiteurId" class="form-control" required>
      <option *ngFor="let v of visiteurs" [value]="v.id">
        {{ v.prenom }} {{ v.nom }}
      </option>
    </select>
  </div>

  <div class="mb-2">
    <label>Date programmée</label>
    <input type="datetime-local" [(ngModel)]="newVisite.dateProgrammee" name="dateProgrammee" class="form-control" required>
  </div>

  <div class="mb-2">
    <label>Statut</label>
    <select [(ngModel)]="newVisite.statut" name="statut" class="form-control">
      <option value="programmee">Programmé</option>
      <option value="effectuee">Effectuée</option>
      <option value="annulee">Annulée</option>
    </select>
  </div>

  <div class="mb-2">
    <label>Commentaire</label>
    <input type="text" [(ngModel)]="newVisite.commentaire" name="commentaire" class="form-control">
  </div>

  <button class="btn btn-primary" type="submit">Ajouter visite</button>
</form>


  <!-- Calendrier FullCalendar -->
  <full-calendar [options]="calendarOptions"></full-calendar>

  <!-- Liste pour modifier le statut rapidement -->
  <h5 class="mt-4">Visites existantes</h5>
  <ul class="list-group">
    <li *ngFor="let v of calendarOptions.events" class="list-group-item d-flex justify-content-between align-items-center">
      {{ v.title }} - Statut: <strong>{{ v.statut }}</strong>
      <div>
        <button class="btn btn-sm btn-success me-1" (click)="changeStatut(v.id, 'effectuee')">Effectuée</button>
        <button class="btn btn-sm btn-danger me-1" (click)="changeStatut(v.id, 'annulee')">Annulée</button>
        <button class="btn btn-sm btn-primary" (click)="changeStatut(v.id, 'programmee')">Programmé</button>
      </div>
    </li>
  </ul>
</div>
